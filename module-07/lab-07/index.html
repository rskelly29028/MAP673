<!DOCTYPE html>
<html>

<head>
    <title>MAP 673 Lab 07</title>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
    <link rel="shortcut icon" href="http://cartodb.com/assets/favicon.ico" />
    <style>
        html, 
        body, 
        #map {
            height: 100%;
            padding: 0;
            margin: 0;
            background: black;
        }
        
        #title {
            position: absolute;
            font-family: "Work Sans", sans-serif;
            left: 5px;
            top: 10px;
        }
        
        h1 {
            padding: 8px 25px 8px 15px;
            margin: 0;
            background: none;
            color: white;
            font-weight: 400;
            font-size: 2em;
            text-align: left;
        }
      
        h2 {
            padding: 8px 25px 8px 15px;
            margin: 0;
            background: none;
            color: white;
            font-weight: 200;
            font-size: 1.5em;
            text-align: left;
        }

        body > div.cartodb-header {
            display: none;
            position: absolute;
            top: 55%;
            left: 1%;
            width: 35%;
            background-color: rgba(0,0,0,0);
            line-height: normal;
            font-family: "Work Sans", sans-serif;
        }
    
  </style> 
    
    <link rel="stylesheet" href="https://cartodb-libs.global.ssl.fastly.net/cartodb.js/v3/3.15/themes/css/cartodb.css" />

    <script type='html' id="legend_template">
 
    <div class='cartodb-legend density'>  
    <ul>
    <li class="min">
    Support for Candidate
    </li>
  
    <li class="graph leg" style="border-radius: 0; border:none">
    <div class="colors">
    <div class="quartile" style="background-color:#E40800"></div>
    <div class="quartile" style="background-color:#E18189"></div>
    <div class="quartile" style="background-color:#E7AFBA"></div>
    <div class="quartile" style="background-color:#BBCEE1"></div>
    <div class="quartile" style="background-color:#4980D7"></div>
    <div class="quartile" style="background-color:#0903AE"></div>
    </div>
    <div class="colors" style="font-weight:normal; text-align: center">
    <div class="quartile" style="padding-top: 5px" >TRUMP</div>
    <div class="quartile" style="padding-top: 5px" > </div>
    <div class="quartile" style="padding-top: 5px" > </div>
    <div class="quartile" style="padding-top: 5px" > </div>
    <div class="quartile" style="padding-top: 5px" > </div>
    <div class="quartile" style="padding-top: 5px" >CLINTON</div>
  </div>
  </li>
  </ul>
  </div>

</script>
    
    </head>

    <body>

    <div id="map"></div>
    <div id="title">
        <h1>GENERAL ELECTION 2016</h1>
        <h2><i>South Carolina by County</i></h2>
        
    </div>  
    
    <script src="https://cartodb-libs.global.ssl.fastly.net/cartodb.js/v3/3.15/cartodb.js"></script>
    <script type="cartocss/html" id="counties-styles">
     
    </script>

    <script>

    var map = L.map('map', {
        center: [33.5,-81],
        zoom: 7.5,
        zoomControl: false,
        maxZoom: 8,
        minZoom: 7
    });
        
    var cartoCSS = "#layer {" + "polygon-fill: ramp([perc_clinton], (#e40800, #e18189, #e7afba, #bbcee1, #4d80d7, #0903ae) quantiles);" +
    "line-width: 2;" +
    "line-color: #FFF;" +
    "line-opacity: 0.75;" +
    "}";

    var sourceObject = {
        user_name: 'rkelly0007',
        type: 'cartodb',
        sublayers: [
        {
            sql: "SELECT * FROM south_carolina",
            cartocss: cartoCSS
        }
        ]
    }

    var legend = new cdb.geo.ui.Legend({
            type: "custom",
            show_title: false,
            title: "",
            template: $('#legend_template').html(),
            visible: true,
            });
        
        $('#map').append(legend.render().el);
        
    cartodb.createLayer(map, sourceObject).addTo(map);

    var i = new cdb.geo.ui.Header({

            model: new cdb.core.Model({
            extra: {
            title: "NOTES ABOUT THE DATA",
            description: "Data From State Board of Elections at http://www.enr-scvotes.org/SC/64658/183653/en/select-county.html, South Carolina JSON file at http://catalog.opendata.city/dataset/south-carolina-counties-polygon/resource/04a2c2f2-3382-4b20-a225-c873ad7678ca",
            show_title: true,
            show_description: true,
            }
        }),
          
     template: cdb.core.Template.compile(' \
        <div class="content">\
        <div class="title">{{{ title }}}</div>\
        <div class="description">{{{ description }}}</div>\
        </div>',
        'mustache'
        )
      });
      
        $('body').append(i.render().el);

    </script>
    
</body>

</html>
